-- Apache Doris Schema for OpenNL2Data-Bench

-- Scenario: ecommerce

-- Generated by SchemaGenerator



-- Note: Apache Doris is MySQL-compatible

-- - Consider data distribution and partitioning for large tables

-- - Use appropriate table models (Duplicate/Aggregate/Unique)



SET NAMES utf8mb4;

SET FOREIGN_KEY_CHECKS = 0;



-- Create database if not exists

CREATE DATABASE IF NOT EXISTS ecommerce;

USE ecommerce;



CREATE TABLE afs_knowledge (
	knowledge_id BIGINT NOT NULL COMMENT '知识ID' AUTO_INCREMENT, 
	category_id BIGINT NOT NULL COMMENT '分类ID', 
	category_name VARCHAR(100) NOT NULL COMMENT '分类名称（冗余）', 
	question VARCHAR(500) NOT NULL COMMENT '问题', 
	answer TEXT NOT NULL COMMENT '答案', 
	keywords VARCHAR(500) COMMENT '关键词（逗号分隔）', 
	applicable_scenario VARCHAR(200) COMMENT '适用场景', 
	knowledge_status SMALLINT NOT NULL COMMENT '状态：0禁用/1启用', 
	view_count BIGINT NOT NULL COMMENT '查看次数', 
	helpful_count BIGINT NOT NULL COMMENT '有帮助次数', 
	unhelpful_count BIGINT NOT NULL COMMENT '无帮助次数', 
	priority SMALLINT NOT NULL COMMENT '优先级', 
	sort_order SMALLINT NOT NULL COMMENT '排序', 
	author_id BIGINT NOT NULL COMMENT '创建人ID', 
	last_modifier_id BIGINT COMMENT '最后修改人ID', 
	created_at DATETIME NOT NULL COMMENT '创建时间', 
	updated_at DATETIME NOT NULL COMMENT '更新时间', 
	is_deleted SMALLINT NOT NULL COMMENT '删除标记：0未删除/1已删除', 
	CONSTRAINT pk_afs_knowledge PRIMARY KEY (knowledge_id)
)COMMENT='售后知识库表';

CREATE TABLE log_logistics_company (
	company_id BIGINT NOT NULL COMMENT '物流公司ID' AUTO_INCREMENT, 
	company_code VARCHAR(50) NOT NULL COMMENT '物流公司编码', 
	company_name VARCHAR(100) NOT NULL COMMENT '物流公司名称', 
	api_url VARCHAR(200) COMMENT '物流查询API地址', 
	api_key VARCHAR(100) COMMENT 'API密钥（加密存储）', 
	service_type SMALLINT NOT NULL COMMENT '服务类型：1快递/2物流/3同城配送', 
	coverage_area TEXT COMMENT '覆盖区域（JSON数组）', 
	base_fee NUMERIC(10, 2) NOT NULL COMMENT '首重费用', 
	additional_fee NUMERIC(10, 2) NOT NULL COMMENT '续重费用', 
	company_status SMALLINT NOT NULL COMMENT '状态：0停用/1启用', 
	sort_order SMALLINT NOT NULL COMMENT '排序', 
	created_at DATETIME NOT NULL COMMENT '创建时间', 
	updated_at DATETIME NOT NULL COMMENT '更新时间', 
	is_deleted SMALLINT NOT NULL COMMENT '删除标记：0未删除/1已删除', 
	CONSTRAINT pk_log_logistics_company PRIMARY KEY (company_id), 
	CONSTRAINT uq_log_logistics_company_company_code UNIQUE (company_code)
)COMMENT='物流公司表';

CREATE TABLE log_shipping_template (
	template_id BIGINT NOT NULL COMMENT '模板ID' AUTO_INCREMENT, 
	template_name VARCHAR(100) NOT NULL COMMENT '模板名称', 
	template_type SMALLINT NOT NULL COMMENT '计费方式：1按件数/2按重量/3按体积', 
	default_first_unit BIGINT NOT NULL COMMENT '首件/首重/首体积', 
	default_first_fee NUMERIC(10, 2) NOT NULL COMMENT '首费', 
	default_additional_unit BIGINT NOT NULL COMMENT '续件/续重/续体积', 
	default_additional_fee NUMERIC(10, 2) NOT NULL COMMENT '续费', 
	free_shipping_type SMALLINT NOT NULL COMMENT '免邮类型：0不免邮/1满金额免邮/2满件数免邮', 
	free_shipping_amount NUMERIC(10, 2) NOT NULL COMMENT '免邮金额', 
	free_shipping_count BIGINT NOT NULL COMMENT '免邮件数', 
	template_status SMALLINT NOT NULL COMMENT '状态：0停用/1启用', 
	created_at DATETIME NOT NULL COMMENT '创建时间', 
	updated_at DATETIME NOT NULL COMMENT '更新时间', 
	is_deleted SMALLINT NOT NULL COMMENT '删除标记：0未删除/1已删除', 
	CONSTRAINT pk_log_shipping_template PRIMARY KEY (template_id)
)COMMENT='运费模板表';

CREATE TABLE log_warehouse (
	warehouse_id BIGINT NOT NULL COMMENT '仓库ID' AUTO_INCREMENT, 
	warehouse_code VARCHAR(50) NOT NULL COMMENT '仓库编码', 
	warehouse_name VARCHAR(100) NOT NULL COMMENT '仓库名称', 
	warehouse_type SMALLINT NOT NULL COMMENT '仓库类型：1自营仓/2第三方仓/3前置仓', 
	province VARCHAR(50) NOT NULL COMMENT '省份', 
	city VARCHAR(50) NOT NULL COMMENT '城市', 
	district VARCHAR(50) NOT NULL COMMENT '区/县', 
	address VARCHAR(200) NOT NULL COMMENT '详细地址', 
	contact_name VARCHAR(50) NOT NULL COMMENT '联系人', 
	contact_phone VARCHAR(20) NOT NULL COMMENT '联系电话', 
	warehouse_status SMALLINT NOT NULL COMMENT '仓库状态：0停用/1启用/2维护中', 
	total_area NUMERIC(10, 2) COMMENT '总面积（平方米）', 
	usable_area NUMERIC(10, 2) COMMENT '可用面积（平方米）', 
	created_at DATETIME NOT NULL COMMENT '创建时间', 
	updated_at DATETIME NOT NULL COMMENT '更新时间', 
	is_deleted SMALLINT NOT NULL COMMENT '删除标记：0未删除/1已删除', 
	CONSTRAINT pk_log_warehouse PRIMARY KEY (warehouse_id), 
	CONSTRAINT uq_log_warehouse_warehouse_code UNIQUE (warehouse_code)
)COMMENT='仓库表';

CREATE TABLE ord_order_main (
	order_id BIGINT NOT NULL COMMENT '订单ID' AUTO_INCREMENT, 
	order_no VARCHAR(32) NOT NULL COMMENT '订单号', 
	user_id BIGINT NOT NULL COMMENT '用户ID', 
	parent_order_id BIGINT COMMENT '父订单ID（订单拆分时使用）', 
	total_amount NUMERIC(12, 2) NOT NULL COMMENT '订单总金额（商品金额之和）', 
	discount_amount NUMERIC(12, 2) NOT NULL COMMENT '优惠金额（促销+优惠券）', 
	shipping_fee NUMERIC(10, 2) NOT NULL COMMENT '运费', 
	actual_amount NUMERIC(12, 2) NOT NULL COMMENT '实付金额（总金额-优惠+运费）', 
	order_status SMALLINT NOT NULL COMMENT '订单状态：0待支付/1已支付/2待发货/3已发货/4已完成/5已取消/6已关闭', 
	payment_status SMALLINT NOT NULL COMMENT '支付状态：0未支付/1部分支付/2已支付/3已退款', 
	shipping_status SMALLINT NOT NULL COMMENT '发货状态：0未发货/1部分发货/2已发货/3已签收', 
	refund_status SMALLINT NOT NULL COMMENT '退款状态：0无退款/1退款中/2部分退款/3全部退款', 
	promotion_id BIGINT COMMENT '促销活动ID', 
	coupon_id BIGINT COMMENT '优惠券ID', 
	shipping_address_id BIGINT NOT NULL COMMENT '收货地址ID', 
	order_time DATETIME NOT NULL COMMENT '下单时间', 
	payment_time DATETIME COMMENT '支付时间', 
	shipping_time DATETIME COMMENT '发货时间', 
	complete_time DATETIME COMMENT '完成时间', 
	cancel_time DATETIME COMMENT '取消时间', 
	order_source SMALLINT NOT NULL COMMENT '订单来源：1PC/2H5/3小程序/4APP/5API', 
	buyer_message VARCHAR(500) COMMENT '买家留言', 
	created_at DATETIME NOT NULL COMMENT '创建时间', 
	updated_at DATETIME NOT NULL COMMENT '更新时间', 
	is_deleted SMALLINT NOT NULL COMMENT '删除标记：0未删除/1已删除', 
	CONSTRAINT pk_ord_order_main PRIMARY KEY (order_id), 
	CONSTRAINT uq_ord_order_main_order_no UNIQUE (order_no)
)COMMENT='订单主表';

CREATE TABLE pay_account_balance (
	account_id BIGINT NOT NULL COMMENT '账户ID' AUTO_INCREMENT, 
	user_id BIGINT NOT NULL COMMENT '用户ID', 
	balance NUMERIC(12, 2) NOT NULL COMMENT '可用余额', 
	frozen_balance NUMERIC(12, 2) NOT NULL COMMENT '冻结余额', 
	total_recharge NUMERIC(12, 2) NOT NULL COMMENT '累计充值金额', 
	total_consume NUMERIC(12, 2) NOT NULL COMMENT '累计消费金额', 
	total_withdraw NUMERIC(12, 2) NOT NULL COMMENT '累计提现金额', 
	account_status SMALLINT NOT NULL COMMENT '账户状态：0冻结/1正常/2注销', 
	version BIGINT NOT NULL COMMENT '版本号（防止并发修改）', 
	created_at DATETIME NOT NULL COMMENT '创建时间', 
	updated_at DATETIME NOT NULL COMMENT '更新时间', 
	CONSTRAINT pk_pay_account_balance PRIMARY KEY (account_id), 
	CONSTRAINT uq_pay_account_balance_user_id UNIQUE (user_id)
)COMMENT='账户余额表';

CREATE TABLE pay_payment_channel (
	channel_id BIGINT NOT NULL COMMENT '渠道ID' AUTO_INCREMENT, 
	channel_code VARCHAR(50) NOT NULL COMMENT '渠道编码（如：ALIPAY、WECHAT）', 
	channel_name VARCHAR(100) NOT NULL COMMENT '渠道名称', 
	channel_type SMALLINT NOT NULL COMMENT '渠道类型：1第三方支付/2银行直连/3账户余额', 
	app_id VARCHAR(100) COMMENT '应用ID', 
	merchant_id VARCHAR(100) COMMENT '商户号', 
	api_config TEXT COMMENT 'API配置（JSON加密）', 
	fee_rate NUMERIC(5, 4) NOT NULL COMMENT '手续费费率（如0.006表示0.6%%）', 
	min_fee NUMERIC(10, 2) NOT NULL COMMENT '最低手续费', 
	max_fee NUMERIC(10, 2) NOT NULL COMMENT '最高手续费', 
	min_amount NUMERIC(10, 2) NOT NULL COMMENT '最小支付金额', 
	max_amount NUMERIC(10, 2) NOT NULL COMMENT '最大支付金额', 
	channel_status SMALLINT NOT NULL COMMENT '渠道状态：0禁用/1启用/2维护中', 
	sort_order SMALLINT NOT NULL COMMENT '排序（数字越小越靠前）', 
	created_at DATETIME NOT NULL COMMENT '创建时间', 
	updated_at DATETIME NOT NULL COMMENT '更新时间', 
	is_deleted SMALLINT NOT NULL COMMENT '删除标记：0未删除/1已删除', 
	CONSTRAINT pk_pay_payment_channel PRIMARY KEY (channel_id), 
	CONSTRAINT uq_pay_payment_channel_channel_code UNIQUE (channel_code)
)COMMENT='支付渠道表';

CREATE TABLE log_delivery_route (
	route_id BIGINT NOT NULL COMMENT '路线ID' AUTO_INCREMENT, 
	route_no VARCHAR(32) NOT NULL COMMENT '路线号', 
	courier_id BIGINT NOT NULL COMMENT '配送员ID', 
	courier_name VARCHAR(50) NOT NULL COMMENT '配送员姓名', 
	courier_phone VARCHAR(20) NOT NULL COMMENT '配送员电话', 
	delivery_date DATETIME NOT NULL COMMENT '配送日期', 
	warehouse_id BIGINT NOT NULL COMMENT '出发仓库ID', 
	route_status SMALLINT NOT NULL COMMENT '路线状态：1待配送/2配送中/3已完成/4已取消', 
	total_orders SMALLINT NOT NULL COMMENT '总订单数', 
	completed_orders SMALLINT NOT NULL COMMENT '已完成订单数', 
	start_time DATETIME COMMENT '出发时间', 
	end_time DATETIME COMMENT '完成时间', 
	created_at DATETIME NOT NULL COMMENT '创建时间', 
	updated_at DATETIME NOT NULL COMMENT '更新时间', 
	CONSTRAINT pk_log_delivery_route PRIMARY KEY (route_id), 
	CONSTRAINT uq_log_delivery_route_route_no UNIQUE (route_no), 
	CONSTRAINT fk_log_delivery_route_warehouse_id_log_warehouse FOREIGN KEY(warehouse_id) REFERENCES log_warehouse (warehouse_id)
)COMMENT='配送路线表';

CREATE TABLE log_inventory (
	inventory_id BIGINT NOT NULL COMMENT '库存ID' AUTO_INCREMENT, 
	warehouse_id BIGINT NOT NULL COMMENT '仓库ID', 
	sku_id BIGINT NOT NULL COMMENT 'SKU ID', 
	available_stock BIGINT NOT NULL COMMENT '可用库存', 
	frozen_stock BIGINT NOT NULL COMMENT '冻结库存', 
	in_transit_stock BIGINT NOT NULL COMMENT '在途库存', 
	safety_stock BIGINT NOT NULL COMMENT '安全库存（预警阈值）', 
	version BIGINT NOT NULL COMMENT '版本号（防止并发修改）', 
	created_at DATETIME NOT NULL COMMENT '创建时间', 
	updated_at DATETIME NOT NULL COMMENT '更新时间', 
	CONSTRAINT pk_log_inventory PRIMARY KEY (inventory_id), 
	CONSTRAINT fk_log_inventory_warehouse_id_log_warehouse FOREIGN KEY(warehouse_id) REFERENCES log_warehouse (warehouse_id)
)COMMENT='库存表';

CREATE TABLE log_shipping_order (
	shipping_id BIGINT NOT NULL COMMENT '发货单ID' AUTO_INCREMENT, 
	shipping_no VARCHAR(32) NOT NULL COMMENT '发货单号', 
	order_id BIGINT NOT NULL COMMENT '订单ID', 
	warehouse_id BIGINT NOT NULL COMMENT '发货仓库ID', 
	logistics_company_id BIGINT NOT NULL COMMENT '物流公司ID', 
	tracking_no VARCHAR(50) NOT NULL COMMENT '物流单号', 
	receiver_name VARCHAR(50) NOT NULL COMMENT '收货人姓名', 
	receiver_phone VARCHAR(20) NOT NULL COMMENT '收货人电话', 
	receiver_province VARCHAR(50) NOT NULL COMMENT '收货省份', 
	receiver_city VARCHAR(50) NOT NULL COMMENT '收货城市', 
	receiver_district VARCHAR(50) NOT NULL COMMENT '收货区县', 
	receiver_address VARCHAR(500) NOT NULL COMMENT '收货详细地址', 
	shipping_status SMALLINT NOT NULL COMMENT '发货状态：1待发货/2已发货/3运输中/4派送中/5已签收/6退回', 
	ship_time DATETIME COMMENT '发货时间', 
	delivery_time DATETIME COMMENT '签收时间', 
	shipping_remark VARCHAR(500) COMMENT '发货备注', 
	created_at DATETIME NOT NULL COMMENT '创建时间', 
	updated_at DATETIME NOT NULL COMMENT '更新时间', 
	CONSTRAINT pk_log_shipping_order PRIMARY KEY (shipping_id), 
	CONSTRAINT uq_log_shipping_order_shipping_no UNIQUE (shipping_no), 
	CONSTRAINT fk_log_shipping_order_order_id_ord_order_main FOREIGN KEY(order_id) REFERENCES ord_order_main (order_id), 
	CONSTRAINT fk_log_shipping_order_warehouse_id_log_warehouse FOREIGN KEY(warehouse_id) REFERENCES log_warehouse (warehouse_id), 
	CONSTRAINT fk_log_shipping_order_logistics_company_id_log_logistics_company FOREIGN KEY(logistics_company_id) REFERENCES log_logistics_company (company_id)
)COMMENT='发货单表';

CREATE TABLE ord_invoice_request (
	request_id BIGINT NOT NULL COMMENT '申请ID' AUTO_INCREMENT, 
	order_id BIGINT NOT NULL COMMENT '订单ID', 
	user_id BIGINT NOT NULL COMMENT '用户ID', 
	invoice_type SMALLINT NOT NULL COMMENT '发票类型：1普通发票/2增值税专用发票', 
	invoice_title_type SMALLINT NOT NULL COMMENT '抬头类型：1个人/2企业', 
	invoice_title VARCHAR(200) NOT NULL COMMENT '发票抬头', 
	tax_no VARCHAR(50) COMMENT '纳税人识别号', 
	company_address VARCHAR(200) COMMENT '公司地址', 
	company_phone VARCHAR(20) COMMENT '公司电话', 
	bank_name VARCHAR(100) COMMENT '开户银行', 
	bank_account VARCHAR(50) COMMENT '银行账号', 
	invoice_amount NUMERIC(12, 2) NOT NULL COMMENT '发票金额', 
	request_status SMALLINT NOT NULL COMMENT '申请状态：1待处理/2已开票/3已拒绝', 
	created_at DATETIME NOT NULL COMMENT '创建时间', 
	updated_at DATETIME NOT NULL COMMENT '更新时间', 
	CONSTRAINT pk_ord_invoice_request PRIMARY KEY (request_id), 
	CONSTRAINT fk_ord_invoice_request_order_id_ord_order_main FOREIGN KEY(order_id) REFERENCES ord_order_main (order_id)
)COMMENT='发票申请表';

CREATE TABLE ord_order_cancel_log (
	cancel_id BIGINT NOT NULL COMMENT '取消ID' AUTO_INCREMENT, 
	order_id BIGINT NOT NULL COMMENT '订单ID', 
	cancel_reason_type SMALLINT NOT NULL COMMENT '取消原因类型：1不想要了/2信息填错/3重复下单/4商品缺货/5价格变动/6其他', 
	cancel_reason VARCHAR(500) NOT NULL COMMENT '取消原因详细描述', 
	operator_id BIGINT NOT NULL COMMENT '操作人ID', 
	operator_type SMALLINT NOT NULL COMMENT '操作人类型：1用户/2系统/3管理员', 
	cancel_time DATETIME NOT NULL COMMENT '取消时间', 
	created_at DATETIME NOT NULL COMMENT '创建时间', 
	updated_at DATETIME NOT NULL COMMENT '更新时间', 
	CONSTRAINT pk_ord_order_cancel_log PRIMARY KEY (cancel_id), 
	CONSTRAINT fk_ord_order_cancel_log_order_id_ord_order_main FOREIGN KEY(order_id) REFERENCES ord_order_main (order_id)
)COMMENT='订单取消日志表';

CREATE TABLE ord_order_delivery (
	delivery_id BIGINT NOT NULL COMMENT '配送ID' AUTO_INCREMENT, 
	order_id BIGINT NOT NULL COMMENT '订单ID', 
	logistics_company VARCHAR(100) NOT NULL COMMENT '物流公司', 
	tracking_no VARCHAR(50) NOT NULL COMMENT '物流单号', 
	delivery_status SMALLINT NOT NULL COMMENT '配送状态：1待揽收/2运输中/3派送中/4已签收/5异常', 
	ship_time DATETIME NOT NULL COMMENT '发货时间', 
	receive_time DATETIME COMMENT '签收时间', 
	receiver_name VARCHAR(50) NOT NULL COMMENT '收货人姓名', 
	receiver_phone VARCHAR(20) NOT NULL COMMENT '收货人电话', 
	receiver_address VARCHAR(500) NOT NULL COMMENT '收货地址', 
	created_at DATETIME NOT NULL COMMENT '创建时间', 
	updated_at DATETIME NOT NULL COMMENT '更新时间', 
	CONSTRAINT pk_ord_order_delivery PRIMARY KEY (delivery_id), 
	CONSTRAINT fk_ord_order_delivery_order_id_ord_order_main FOREIGN KEY(order_id) REFERENCES ord_order_main (order_id)
)COMMENT='订单配送表';

CREATE TABLE ord_order_evaluation (
	evaluation_id BIGINT NOT NULL COMMENT '评价ID' AUTO_INCREMENT, 
	order_id BIGINT NOT NULL COMMENT '订单ID', 
	user_id BIGINT NOT NULL COMMENT '用户ID', 
	product_score SMALLINT NOT NULL COMMENT '商品评分（1-5）', 
	service_score SMALLINT NOT NULL COMMENT '服务评分（1-5）', 
	logistics_score SMALLINT NOT NULL COMMENT '物流评分（1-5）', 
	evaluation_content TEXT COMMENT '评价内容', 
	evaluation_images TEXT COMMENT '评价图片（JSON数组）', 
	evaluation_status SMALLINT NOT NULL COMMENT '评价状态：1待审核/2已发布/3已屏蔽', 
	is_anonymous SMALLINT NOT NULL COMMENT '是否匿名：0否/1是', 
	append_content TEXT COMMENT '追加评价内容', 
	append_time DATETIME COMMENT '追评时间', 
	created_at DATETIME NOT NULL COMMENT '创建时间', 
	updated_at DATETIME NOT NULL COMMENT '更新时间', 
	CONSTRAINT pk_ord_order_evaluation PRIMARY KEY (evaluation_id), 
	CONSTRAINT fk_ord_order_evaluation_order_id_ord_order_main FOREIGN KEY(order_id) REFERENCES ord_order_main (order_id)
)COMMENT='订单评价表';

CREATE TABLE ord_order_item (
	item_id BIGINT NOT NULL COMMENT '明细ID' AUTO_INCREMENT, 
	order_id BIGINT NOT NULL COMMENT '订单ID', 
	product_id BIGINT NOT NULL COMMENT '商品ID', 
	sku_id BIGINT NOT NULL COMMENT 'SKU ID', 
	product_name VARCHAR(200) NOT NULL COMMENT '商品名称', 
	sku_name VARCHAR(200) NOT NULL COMMENT 'SKU名称', 
	sku_attrs TEXT COMMENT 'SKU属性JSON（颜色、尺码等）', 
	product_image VARCHAR(500) NOT NULL COMMENT '商品图片URL', 
	original_price NUMERIC(10, 2) NOT NULL COMMENT '商品原价（单价）', 
	unit_price NUMERIC(10, 2) NOT NULL COMMENT '成交单价（可能含促销）', 
	quantity SMALLINT NOT NULL COMMENT '购买数量', 
	discount_amount NUMERIC(10, 2) NOT NULL COMMENT '优惠金额', 
	actual_amount NUMERIC(10, 2) NOT NULL COMMENT '实付金额（单价*数量-优惠）', 
	refund_quantity SMALLINT NOT NULL COMMENT '已退款数量', 
	refund_amount NUMERIC(10, 2) NOT NULL COMMENT '已退款金额', 
	item_status SMALLINT NOT NULL COMMENT '明细状态：1正常/2已退款/3已取消', 
	created_at DATETIME NOT NULL COMMENT '创建时间', 
	updated_at DATETIME NOT NULL COMMENT '更新时间', 
	CONSTRAINT pk_ord_order_item PRIMARY KEY (item_id), 
	CONSTRAINT fk_ord_order_item_order_id_ord_order_main FOREIGN KEY(order_id) REFERENCES ord_order_main (order_id)
)COMMENT='订单明细表';

CREATE TABLE ord_order_log (
	log_id BIGINT NOT NULL COMMENT '日志ID' AUTO_INCREMENT, 
	order_id BIGINT NOT NULL COMMENT '订单ID', 
	operation_type SMALLINT NOT NULL COMMENT '操作类型：1创建订单/2支付/3发货/4签收/5评价/6取消/7退款', 
	operation_desc VARCHAR(500) NOT NULL COMMENT '操作描述', 
	old_status SMALLINT COMMENT '变更前状态', 
	new_status SMALLINT COMMENT '变更后状态', 
	operator_id BIGINT COMMENT '操作人ID（用户或管理员）', 
	operator_type SMALLINT NOT NULL COMMENT '操作人类型：1用户/2系统/3管理员', 
	created_at DATETIME NOT NULL COMMENT '创建时间', 
	CONSTRAINT pk_ord_order_log PRIMARY KEY (log_id), 
	CONSTRAINT fk_ord_order_log_order_id_ord_order_main FOREIGN KEY(order_id) REFERENCES ord_order_main (order_id)
)COMMENT='订单日志表';

CREATE TABLE ord_order_payment (
	payment_id BIGINT NOT NULL COMMENT '支付ID' AUTO_INCREMENT, 
	order_id BIGINT NOT NULL COMMENT '订单ID', 
	payment_no VARCHAR(32) NOT NULL COMMENT '支付流水号', 
	payment_method SMALLINT NOT NULL COMMENT '支付方式：1支付宝/2微信/3银行卡/4余额/5货到付款', 
	payment_amount NUMERIC(12, 2) NOT NULL COMMENT '支付金额', 
	trade_no VARCHAR(64) COMMENT '第三方支付流水号', 
	payment_channel VARCHAR(50) COMMENT '支付渠道（如：支付宝、微信支付）', 
	payment_status SMALLINT NOT NULL COMMENT '支付状态：0待支付/1支付中/2已支付/3支付失败/4已退款', 
	payment_time DATETIME COMMENT '支付完成时间', 
	remark VARCHAR(500) COMMENT '备注', 
	created_at DATETIME NOT NULL COMMENT '创建时间', 
	updated_at DATETIME NOT NULL COMMENT '更新时间', 
	CONSTRAINT pk_ord_order_payment PRIMARY KEY (payment_id), 
	CONSTRAINT fk_ord_order_payment_order_id_ord_order_main FOREIGN KEY(order_id) REFERENCES ord_order_main (order_id), 
	CONSTRAINT uq_ord_order_payment_payment_no UNIQUE (payment_no)
)COMMENT='订单支付表';

CREATE TABLE ord_order_promotion (
	id BIGINT NOT NULL COMMENT '主键ID' AUTO_INCREMENT, 
	order_id BIGINT NOT NULL COMMENT '订单ID', 
	promotion_id BIGINT NOT NULL COMMENT '促销活动ID', 
	promotion_type SMALLINT NOT NULL COMMENT '促销类型：1满减/2折扣/3满赠/4优惠券/5积分抵扣', 
	promotion_name VARCHAR(100) NOT NULL COMMENT '促销活动名称', 
	discount_amount NUMERIC(10, 2) NOT NULL COMMENT '优惠金额', 
	rule_desc VARCHAR(500) COMMENT '促销规则描述', 
	created_at DATETIME NOT NULL COMMENT '创建时间', 
	updated_at DATETIME NOT NULL COMMENT '更新时间', 
	CONSTRAINT pk_ord_order_promotion PRIMARY KEY (id), 
	CONSTRAINT fk_ord_order_promotion_order_id_ord_order_main FOREIGN KEY(order_id) REFERENCES ord_order_main (order_id)
)COMMENT='订单促销表';

CREATE TABLE ord_order_split (
	split_id BIGINT NOT NULL COMMENT '拆分ID' AUTO_INCREMENT, 
	parent_order_id BIGINT NOT NULL COMMENT '父订单ID', 
	child_order_id BIGINT NOT NULL COMMENT '子订单ID', 
	split_reason SMALLINT NOT NULL COMMENT '拆分原因：1多商家/2部分发货/3库存不足/4其他', 
	split_desc VARCHAR(500) COMMENT '拆分说明', 
	created_at DATETIME NOT NULL COMMENT '创建时间', 
	updated_at DATETIME NOT NULL COMMENT '更新时间', 
	CONSTRAINT pk_ord_order_split PRIMARY KEY (split_id), 
	CONSTRAINT fk_ord_order_split_parent_order_id_ord_order_main FOREIGN KEY(parent_order_id) REFERENCES ord_order_main (order_id), 
	CONSTRAINT fk_ord_order_split_child_order_id_ord_order_main FOREIGN KEY(child_order_id) REFERENCES ord_order_main (order_id)
)COMMENT='订单拆分表';

CREATE TABLE pay_balance_log (
	log_id BIGINT NOT NULL COMMENT '日志ID' AUTO_INCREMENT, 
	account_id BIGINT NOT NULL COMMENT '账户ID', 
	user_id BIGINT NOT NULL COMMENT '用户ID（冗余）', 
	business_no VARCHAR(32) NOT NULL COMMENT '业务单号', 
	business_type SMALLINT NOT NULL COMMENT '业务类型：1充值/2消费/3退款/4提现/5冻结/6解冻', 
	change_type SMALLINT NOT NULL COMMENT '变动类型：1增加/2减少', 
	change_amount NUMERIC(12, 2) NOT NULL COMMENT '变动金额', 
	before_balance NUMERIC(12, 2) NOT NULL COMMENT '变动前余额', 
	after_balance NUMERIC(12, 2) NOT NULL COMMENT '变动后余额', 
	change_desc VARCHAR(500) COMMENT '变动说明', 
	created_at DATETIME NOT NULL COMMENT '创建时间', 
	CONSTRAINT pk_pay_balance_log PRIMARY KEY (log_id), 
	CONSTRAINT fk_pay_balance_log_account_id_pay_account_balance FOREIGN KEY(account_id) REFERENCES pay_account_balance (account_id)
)COMMENT='余额变动日志表';

CREATE TABLE pay_payment_order (
	payment_id BIGINT NOT NULL COMMENT '支付ID' AUTO_INCREMENT, 
	payment_no VARCHAR(32) NOT NULL COMMENT '支付单号（内部）', 
	business_no VARCHAR(32) NOT NULL COMMENT '业务订单号（如订单号）', 
	business_type SMALLINT NOT NULL COMMENT '业务类型：1订单支付/2充值/3保证金/4其他', 
	user_id BIGINT NOT NULL COMMENT '用户ID', 
	payment_amount NUMERIC(12, 2) NOT NULL COMMENT '支付金额', 
	actual_amount NUMERIC(12, 2) NOT NULL COMMENT '实际到账金额（扣除手续费后）', 
	fee_amount NUMERIC(10, 2) NOT NULL COMMENT '手续费', 
	channel_id BIGINT NOT NULL COMMENT '支付渠道ID', 
	channel_code VARCHAR(50) NOT NULL COMMENT '渠道编码（冗余）', 
	payment_method SMALLINT NOT NULL COMMENT '支付方式：1支付宝/2微信/3银行卡/4余额/5货到付款/6组合支付', 
	trade_no VARCHAR(64) COMMENT '第三方支付流水号', 
	payment_status SMALLINT NOT NULL COMMENT '支付状态：0待支付/1支付中/2已支付/3支付失败/4已关闭/5已退款', 
	request_time DATETIME NOT NULL COMMENT '发起支付时间', 
	payment_time DATETIME COMMENT '支付完成时间', 
	close_time DATETIME COMMENT '关闭时间', 
	expire_time DATETIME NOT NULL COMMENT '支付过期时间', 
	client_ip VARCHAR(50) COMMENT '客户端IP', 
	device_info VARCHAR(200) COMMENT '设备信息', 
	remark VARCHAR(500) COMMENT '备注', 
	created_at DATETIME NOT NULL COMMENT '创建时间', 
	updated_at DATETIME NOT NULL COMMENT '更新时间', 
	CONSTRAINT pk_pay_payment_order PRIMARY KEY (payment_id), 
	CONSTRAINT uq_pay_payment_order_payment_no UNIQUE (payment_no), 
	CONSTRAINT fk_pay_payment_order_channel_id_pay_payment_channel FOREIGN KEY(channel_id) REFERENCES pay_payment_channel (channel_id)
)COMMENT='支付订单表';

CREATE TABLE pay_settlement_record (
	settlement_id BIGINT NOT NULL COMMENT '结算ID' AUTO_INCREMENT, 
	settlement_no VARCHAR(32) NOT NULL COMMENT '结算单号', 
	channel_id BIGINT NOT NULL COMMENT '支付渠道ID', 
	settlement_cycle SMALLINT NOT NULL COMMENT '结算周期：1日结/2周结/3月结', 
	settlement_date DATETIME NOT NULL COMMENT '结算日期', 
	start_time DATETIME NOT NULL COMMENT '结算开始时间', 
	end_time DATETIME NOT NULL COMMENT '结算结束时间', 
	total_amount NUMERIC(12, 2) NOT NULL COMMENT '总交易金额', 
	total_fee NUMERIC(12, 2) NOT NULL COMMENT '总手续费', 
	settlement_amount NUMERIC(12, 2) NOT NULL COMMENT '实际结算金额', 
	total_count BIGINT NOT NULL COMMENT '总交易笔数', 
	success_count BIGINT NOT NULL COMMENT '成功交易笔数', 
	refund_count BIGINT NOT NULL COMMENT '退款笔数', 
	settlement_status SMALLINT NOT NULL COMMENT '结算状态：0待结算/1已结算/2结算失败', 
	bank_name VARCHAR(100) COMMENT '结算银行', 
	bank_account VARCHAR(50) COMMENT '结算账号', 
	remark VARCHAR(500) COMMENT '备注', 
	created_at DATETIME NOT NULL COMMENT '创建时间', 
	updated_at DATETIME NOT NULL COMMENT '更新时间', 
	CONSTRAINT pk_pay_settlement_record PRIMARY KEY (settlement_id), 
	CONSTRAINT uq_pay_settlement_record_settlement_no UNIQUE (settlement_no), 
	CONSTRAINT fk_pay_settlement_record_channel_id_pay_payment_channel FOREIGN KEY(channel_id) REFERENCES pay_payment_channel (channel_id)
)COMMENT='结算记录表';

CREATE TABLE log_package_info (
	package_id BIGINT NOT NULL COMMENT '包裹ID' AUTO_INCREMENT, 
	package_no VARCHAR(32) NOT NULL COMMENT '包裹号', 
	shipping_id BIGINT NOT NULL COMMENT '发货单ID', 
	package_weight NUMERIC(10, 3) NOT NULL COMMENT '包裹重量（kg）', 
	package_length NUMERIC(10, 2) NOT NULL COMMENT '包裹长度（cm）', 
	package_width NUMERIC(10, 2) NOT NULL COMMENT '包裹宽度（cm）', 
	package_height NUMERIC(10, 2) NOT NULL COMMENT '包裹高度（cm）', 
	package_volume NUMERIC(10, 3) NOT NULL COMMENT '包裹体积（立方米）', 
	package_type SMALLINT NOT NULL COMMENT '包裹类型：1标准包裹/2大件/3易碎品/4特殊物品', 
	packer_id BIGINT COMMENT '打包人ID', 
	pack_time DATETIME COMMENT '打包时间', 
	package_remark VARCHAR(500) COMMENT '包裹备注', 
	created_at DATETIME NOT NULL COMMENT '创建时间', 
	updated_at DATETIME NOT NULL COMMENT '更新时间', 
	CONSTRAINT pk_log_package_info PRIMARY KEY (package_id), 
	CONSTRAINT uq_log_package_info_package_no UNIQUE (package_no), 
	CONSTRAINT fk_log_package_info_shipping_id_log_shipping_order FOREIGN KEY(shipping_id) REFERENCES log_shipping_order (shipping_id)
)COMMENT='包裹信息表';

CREATE TABLE log_shipping_item (
	item_id BIGINT NOT NULL COMMENT '明细ID' AUTO_INCREMENT, 
	shipping_id BIGINT NOT NULL COMMENT '发货单ID', 
	order_item_id BIGINT NOT NULL COMMENT '订单明细ID', 
	sku_id BIGINT NOT NULL COMMENT 'SKU ID', 
	product_name VARCHAR(200) NOT NULL COMMENT '商品名称', 
	sku_name VARCHAR(200) NOT NULL COMMENT 'SKU名称', 
	shipping_quantity SMALLINT NOT NULL COMMENT '发货数量', 
	received_quantity SMALLINT NOT NULL COMMENT '签收数量', 
	created_at DATETIME NOT NULL COMMENT '创建时间', 
	updated_at DATETIME NOT NULL COMMENT '更新时间', 
	CONSTRAINT pk_log_shipping_item PRIMARY KEY (item_id), 
	CONSTRAINT fk_log_shipping_item_shipping_id_log_shipping_order FOREIGN KEY(shipping_id) REFERENCES log_shipping_order (shipping_id), 
	CONSTRAINT fk_log_shipping_item_order_item_id_ord_order_item FOREIGN KEY(order_item_id) REFERENCES ord_order_item (item_id)
)COMMENT='发货明细表';

CREATE TABLE log_tracking_info (
	tracking_id BIGINT NOT NULL COMMENT '跟踪ID' AUTO_INCREMENT, 
	shipping_id BIGINT NOT NULL COMMENT '发货单ID', 
	tracking_status SMALLINT NOT NULL COMMENT '物流状态：1已揽收/2运输中/3到达派送城市/4派送中/5已签收/6异常', 
	tracking_location VARCHAR(200) NOT NULL COMMENT '所在地', 
	tracking_desc VARCHAR(500) NOT NULL COMMENT '轨迹描述', 
	tracking_time DATETIME NOT NULL COMMENT '轨迹时间', 
	operator VARCHAR(50) COMMENT '操作人', 
	created_at DATETIME NOT NULL COMMENT '创建时间', 
	updated_at DATETIME NOT NULL COMMENT '更新时间', 
	CONSTRAINT pk_log_tracking_info PRIMARY KEY (tracking_id), 
	CONSTRAINT fk_log_tracking_info_shipping_id_log_shipping_order FOREIGN KEY(shipping_id) REFERENCES log_shipping_order (shipping_id)
)COMMENT='物流跟踪表';

CREATE TABLE ord_order_invoice (
	invoice_id BIGINT NOT NULL COMMENT '发票ID' AUTO_INCREMENT, 
	order_id BIGINT NOT NULL COMMENT '订单ID', 
	request_id BIGINT NOT NULL COMMENT '申请ID', 
	invoice_no VARCHAR(50) NOT NULL COMMENT '发票号码', 
	invoice_code VARCHAR(50) NOT NULL COMMENT '发票代码', 
	invoice_url VARCHAR(500) COMMENT '电子发票URL', 
	issue_time DATETIME NOT NULL COMMENT '开票时间', 
	created_at DATETIME NOT NULL COMMENT '创建时间', 
	updated_at DATETIME NOT NULL COMMENT '更新时间', 
	CONSTRAINT pk_ord_order_invoice PRIMARY KEY (invoice_id), 
	CONSTRAINT fk_ord_order_invoice_order_id_ord_order_main FOREIGN KEY(order_id) REFERENCES ord_order_main (order_id), 
	CONSTRAINT fk_ord_order_invoice_request_id_ord_invoice_request FOREIGN KEY(request_id) REFERENCES ord_invoice_request (request_id), 
	CONSTRAINT uq_ord_order_invoice_invoice_no UNIQUE (invoice_no)
)COMMENT='订单发票表';

CREATE TABLE ord_refund (
	refund_id BIGINT NOT NULL COMMENT '退款ID' AUTO_INCREMENT, 
	refund_no VARCHAR(32) NOT NULL COMMENT '退款单号', 
	order_id BIGINT NOT NULL COMMENT '订单ID', 
	item_id BIGINT COMMENT '订单明细ID（单品退款时使用）', 
	user_id BIGINT NOT NULL COMMENT '用户ID', 
	refund_type SMALLINT NOT NULL COMMENT '退款类型：1仅退款/2退货退款', 
	refund_amount NUMERIC(10, 2) NOT NULL COMMENT '退款金额', 
	refund_quantity SMALLINT NOT NULL COMMENT '退款数量（退货时使用）', 
	refund_reason VARCHAR(500) NOT NULL COMMENT '退款原因', 
	refund_desc TEXT COMMENT '退款说明', 
	refund_images TEXT COMMENT '退款凭证图片（JSON数组）', 
	refund_status SMALLINT NOT NULL COMMENT '退款状态：0待审核/1已同意/2已拒绝/3退货中/4已退款/5已完成/6已取消', 
	approve_user_id BIGINT COMMENT '审核人ID', 
	approve_remark VARCHAR(500) COMMENT '审核备注', 
	apply_time DATETIME NOT NULL COMMENT '申请时间', 
	approve_time DATETIME COMMENT '审核时间', 
	refund_time DATETIME COMMENT '退款时间', 
	complete_time DATETIME COMMENT '完成时间', 
	created_at DATETIME NOT NULL COMMENT '创建时间', 
	updated_at DATETIME NOT NULL COMMENT '更新时间', 
	CONSTRAINT pk_ord_refund PRIMARY KEY (refund_id), 
	CONSTRAINT uq_ord_refund_refund_no UNIQUE (refund_no), 
	CONSTRAINT fk_ord_refund_order_id_ord_order_main FOREIGN KEY(order_id) REFERENCES ord_order_main (order_id), 
	CONSTRAINT fk_ord_refund_item_id_ord_order_item FOREIGN KEY(item_id) REFERENCES ord_order_item (item_id)
)COMMENT='退款单表';

CREATE TABLE pay_payment_callback (
	callback_id BIGINT NOT NULL COMMENT '回调ID' AUTO_INCREMENT, 
	payment_id BIGINT COMMENT '支付订单ID（可能回调时还未匹配到订单）', 
	callback_type SMALLINT NOT NULL COMMENT '回调类型：1支付回调/2退款回调', 
	channel_code VARCHAR(50) NOT NULL COMMENT '渠道编码', 
	callback_data TEXT NOT NULL COMMENT '回调原始数据（JSON）', 
	handle_status SMALLINT NOT NULL COMMENT '处理状态：0待处理/1处理成功/2处理失败', 
	handle_times SMALLINT NOT NULL COMMENT '处理次数', 
	sign_verify SMALLINT NOT NULL COMMENT '验签结果：0未验签/1验签成功/2验签失败', 
	callback_time DATETIME NOT NULL COMMENT '回调时间', 
	handle_time DATETIME COMMENT '处理完成时间', 
	error_msg VARCHAR(500) COMMENT '错误信息', 
	created_at DATETIME NOT NULL COMMENT '创建时间', 
	updated_at DATETIME NOT NULL COMMENT '更新时间', 
	CONSTRAINT pk_pay_payment_callback PRIMARY KEY (callback_id), 
	CONSTRAINT fk_pay_payment_callback_payment_id_pay_payment_order FOREIGN KEY(payment_id) REFERENCES pay_payment_order (payment_id)
)COMMENT='支付回调记录表';

CREATE TABLE pay_payment_flow (
	flow_id BIGINT NOT NULL COMMENT '流水ID' AUTO_INCREMENT, 
	flow_no VARCHAR(32) NOT NULL COMMENT '流水号', 
	payment_id BIGINT NOT NULL COMMENT '支付订单ID', 
	flow_type SMALLINT NOT NULL COMMENT '流水类型：1支付请求/2支付回调/3查询/4退款/5退款回调', 
	flow_amount NUMERIC(12, 2) NOT NULL COMMENT '流水金额', 
	channel_flow_no VARCHAR(64) COMMENT '渠道流水号', 
	channel_request TEXT COMMENT '请求内容（JSON）', 
	channel_response TEXT COMMENT '响应内容（JSON）', 
	flow_status SMALLINT NOT NULL COMMENT '流水状态：0处理中/1成功/2失败', 
	error_code VARCHAR(50) COMMENT '错误码', 
	error_msg VARCHAR(500) COMMENT '错误信息', 
	created_at DATETIME NOT NULL COMMENT '创建时间', 
	updated_at DATETIME NOT NULL COMMENT '更新时间', 
	CONSTRAINT pk_pay_payment_flow PRIMARY KEY (flow_id), 
	CONSTRAINT uq_pay_payment_flow_flow_no UNIQUE (flow_no), 
	CONSTRAINT fk_pay_payment_flow_payment_id_pay_payment_order FOREIGN KEY(payment_id) REFERENCES pay_payment_order (payment_id)
)COMMENT='支付流水表';

CREATE TABLE pay_refund_flow (
	refund_flow_id BIGINT NOT NULL COMMENT '退款流水ID' AUTO_INCREMENT, 
	refund_no VARCHAR(32) NOT NULL COMMENT '退款单号', 
	payment_id BIGINT NOT NULL COMMENT '原支付订单ID', 
	business_refund_no VARCHAR(32) NOT NULL COMMENT '业务退款单号（如订单退款单号）', 
	refund_amount NUMERIC(12, 2) NOT NULL COMMENT '退款金额', 
	actual_refund_amount NUMERIC(12, 2) NOT NULL COMMENT '实际退款金额', 
	channel_refund_no VARCHAR(64) COMMENT '渠道退款流水号', 
	refund_status SMALLINT NOT NULL COMMENT '退款状态：0退款中/1退款成功/2退款失败', 
	refund_request_time DATETIME NOT NULL COMMENT '退款请求时间', 
	refund_success_time DATETIME COMMENT '退款成功时间', 
	refund_reason VARCHAR(500) COMMENT '退款原因', 
	created_at DATETIME NOT NULL COMMENT '创建时间', 
	updated_at DATETIME NOT NULL COMMENT '更新时间', 
	CONSTRAINT pk_pay_refund_flow PRIMARY KEY (refund_flow_id), 
	CONSTRAINT uq_pay_refund_flow_refund_no UNIQUE (refund_no), 
	CONSTRAINT fk_pay_refund_flow_payment_id_pay_payment_order FOREIGN KEY(payment_id) REFERENCES pay_payment_order (payment_id)
)COMMENT='退款流水表';

CREATE TABLE afs_ticket (
	ticket_id BIGINT NOT NULL COMMENT '工单ID' AUTO_INCREMENT, 
	ticket_no VARCHAR(32) NOT NULL COMMENT '工单号', 
	user_id BIGINT NOT NULL COMMENT '用户ID', 
	order_id BIGINT COMMENT '订单ID', 
	refund_id BIGINT COMMENT '退款单ID', 
	ticket_type SMALLINT NOT NULL COMMENT '工单类型：1订单咨询/2物流咨询/3退款问题/4商品质量/5其他', 
	ticket_category VARCHAR(100) NOT NULL COMMENT '问题分类（如：发货慢、商品质量、退款退货等）', 
	ticket_title VARCHAR(200) NOT NULL COMMENT '工单标题', 
	ticket_desc TEXT NOT NULL COMMENT '问题详细描述', 
	ticket_images TEXT COMMENT '问题图片（JSON数组）', 
	priority_level SMALLINT NOT NULL COMMENT '优先级：1低/2中/3高/4紧急', 
	ticket_status SMALLINT NOT NULL COMMENT '工单状态：1待分配/2处理中/3待用户确认/4已解决/5已关闭', 
	assigned_agent_id BIGINT COMMENT '分配客服ID', 
	assigned_time DATETIME COMMENT '分配时间', 
	first_response_time DATETIME COMMENT '首次响应时间', 
	resolve_time DATETIME COMMENT '解决时间', 
	solution_desc TEXT COMMENT '解决方案描述', 
	internal_note TEXT COMMENT '内部备注（用户不可见）', 
	satisfaction_score SMALLINT COMMENT '满意度评分（1-5）', 
	satisfaction_comment VARCHAR(500) COMMENT '满意度评价', 
	sla_first_response_deadline DATETIME COMMENT '首次响应截止时间', 
	sla_resolution_deadline DATETIME COMMENT '问题解决截止时间', 
	sla_breached SMALLINT NOT NULL COMMENT '是否违反SLA：0否/1是', 
	created_at DATETIME NOT NULL COMMENT '创建时间', 
	updated_at DATETIME NOT NULL COMMENT '更新时间', 
	CONSTRAINT pk_afs_ticket PRIMARY KEY (ticket_id), 
	CONSTRAINT uq_afs_ticket_ticket_no UNIQUE (ticket_no), 
	CONSTRAINT fk_afs_ticket_order_id_ord_order_main FOREIGN KEY(order_id) REFERENCES ord_order_main (order_id), 
	CONSTRAINT fk_afs_ticket_refund_id_ord_refund FOREIGN KEY(refund_id) REFERENCES ord_refund (refund_id)
)COMMENT='售后工单表';

CREATE TABLE log_return_shipping (
	return_shipping_id BIGINT NOT NULL COMMENT '退货物流ID' AUTO_INCREMENT, 
	refund_id BIGINT NOT NULL COMMENT '退款单ID', 
	logistics_company_id BIGINT NOT NULL COMMENT '物流公司ID', 
	return_tracking_no VARCHAR(50) NOT NULL COMMENT '退货物流单号', 
	sender_name VARCHAR(50) NOT NULL COMMENT '寄件人姓名', 
	sender_phone VARCHAR(20) NOT NULL COMMENT '寄件人电话', 
	sender_address VARCHAR(500) NOT NULL COMMENT '寄件地址', 
	return_warehouse_id BIGINT COMMENT '退货仓库ID', 
	return_address VARCHAR(500) NOT NULL COMMENT '退货地址', 
	return_status SMALLINT NOT NULL COMMENT '退货状态：1待寄回/2已寄回/3运输中/4已入库/5异常', 
	ship_time DATETIME COMMENT '寄出时间', 
	receive_time DATETIME COMMENT '入库时间', 
	created_at DATETIME NOT NULL COMMENT '创建时间', 
	updated_at DATETIME NOT NULL COMMENT '更新时间', 
	CONSTRAINT pk_log_return_shipping PRIMARY KEY (return_shipping_id), 
	CONSTRAINT fk_log_return_shipping_refund_id_ord_refund FOREIGN KEY(refund_id) REFERENCES ord_refund (refund_id), 
	CONSTRAINT fk_log_return_shipping_logistics_company_id_log_logistic_7f4f FOREIGN KEY(logistics_company_id) REFERENCES log_logistics_company (company_id), 
	CONSTRAINT fk_log_return_shipping_return_warehouse_id_log_warehouse FOREIGN KEY(return_warehouse_id) REFERENCES log_warehouse (warehouse_id)
)COMMENT='退货物流表';

CREATE TABLE ord_aftersales_dispute (
	dispute_id BIGINT NOT NULL COMMENT '纠纷ID' AUTO_INCREMENT, 
	refund_id BIGINT NOT NULL COMMENT '退款单ID', 
	user_id BIGINT NOT NULL COMMENT '用户ID', 
	dispute_reason VARCHAR(500) NOT NULL COMMENT '纠纷原因', 
	dispute_desc TEXT COMMENT '纠纷详细说明', 
	dispute_images TEXT COMMENT '纠纷凭证图片（JSON数组）', 
	dispute_status SMALLINT NOT NULL COMMENT '纠纷状态：1待处理/2处理中/3已解决/4已关闭', 
	handler_id BIGINT COMMENT '处理人ID（客服）', 
	handle_result TEXT COMMENT '处理结果', 
	dispute_time DATETIME NOT NULL COMMENT '发起时间', 
	handle_time DATETIME COMMENT '处理时间', 
	created_at DATETIME NOT NULL COMMENT '创建时间', 
	updated_at DATETIME NOT NULL COMMENT '更新时间', 
	CONSTRAINT pk_ord_aftersales_dispute PRIMARY KEY (dispute_id), 
	CONSTRAINT fk_ord_aftersales_dispute_refund_id_ord_refund FOREIGN KEY(refund_id) REFERENCES ord_refund (refund_id)
)COMMENT='售后纠纷表';

CREATE TABLE ord_aftersales_evaluation (
	evaluation_id BIGINT NOT NULL COMMENT '评价ID' AUTO_INCREMENT, 
	refund_id BIGINT NOT NULL COMMENT '退款单ID', 
	user_id BIGINT NOT NULL COMMENT '用户ID', 
	service_score SMALLINT NOT NULL COMMENT '服务评分（1-5）', 
	process_score SMALLINT NOT NULL COMMENT '流程评分（1-5）', 
	speed_score SMALLINT NOT NULL COMMENT '速度评分（1-5）', 
	evaluation_content TEXT COMMENT '评价内容', 
	evaluation_status SMALLINT NOT NULL COMMENT '评价状态：1待审核/2已发布/3已屏蔽', 
	created_at DATETIME NOT NULL COMMENT '创建时间', 
	updated_at DATETIME NOT NULL COMMENT '更新时间', 
	CONSTRAINT pk_ord_aftersales_evaluation PRIMARY KEY (evaluation_id), 
	CONSTRAINT fk_ord_aftersales_evaluation_refund_id_ord_refund FOREIGN KEY(refund_id) REFERENCES ord_refund (refund_id)
)COMMENT='售后评价表';

CREATE TABLE ord_aftersales_log (
	log_id BIGINT NOT NULL COMMENT '日志ID' AUTO_INCREMENT, 
	refund_id BIGINT NOT NULL COMMENT '退款单ID', 
	operation_type SMALLINT NOT NULL COMMENT '操作类型：1申请退款/2审核通过/3审核拒绝/4退货/5退款/6完成/7取消', 
	operation_desc VARCHAR(500) NOT NULL COMMENT '操作描述', 
	operator_id BIGINT COMMENT '操作人ID', 
	operator_type SMALLINT NOT NULL COMMENT '操作人类型：1用户/2系统/3客服', 
	created_at DATETIME NOT NULL COMMENT '创建时间', 
	CONSTRAINT pk_ord_aftersales_log PRIMARY KEY (log_id), 
	CONSTRAINT fk_ord_aftersales_log_refund_id_ord_refund FOREIGN KEY(refund_id) REFERENCES ord_refund (refund_id)
)COMMENT='售后日志表';

CREATE TABLE afs_quality (
	quality_id BIGINT NOT NULL COMMENT '质检ID' AUTO_INCREMENT, 
	ticket_id BIGINT NOT NULL COMMENT '工单ID', 
	agent_id BIGINT NOT NULL COMMENT '客服ID', 
	inspector_id BIGINT NOT NULL COMMENT '质检员ID', 
	quality_date DATETIME NOT NULL COMMENT '质检日期', 
	response_time_score SMALLINT NOT NULL COMMENT '响应时效评分', 
	service_attitude_score SMALLINT NOT NULL COMMENT '服务态度评分', 
	professional_score SMALLINT NOT NULL COMMENT '专业能力评分', 
	problem_solving_score SMALLINT NOT NULL COMMENT '问题解决评分', 
	communication_score SMALLINT NOT NULL COMMENT '沟通技巧评分', 
	total_score SMALLINT NOT NULL COMMENT '总分', 
	quality_result SMALLINT NOT NULL COMMENT '质检结果：1优秀/2良好/3合格/4不合格', 
	problem_desc TEXT COMMENT '存在问题描述', 
	improvement_advice TEXT COMMENT '改进建议', 
	need_retraining SMALLINT NOT NULL COMMENT '是否需要复训：0否/1是', 
	quality_type SMALLINT NOT NULL COMMENT '质检类型：1随机质检/2专项质检/3投诉质检', 
	remark VARCHAR(500) COMMENT '备注', 
	created_at DATETIME NOT NULL COMMENT '创建时间', 
	updated_at DATETIME NOT NULL COMMENT '更新时间', 
	CONSTRAINT pk_afs_quality PRIMARY KEY (quality_id), 
	CONSTRAINT fk_afs_quality_ticket_id_afs_ticket FOREIGN KEY(ticket_id) REFERENCES afs_ticket (ticket_id)
)COMMENT='售后质检表';



-- Re-enable foreign key checks

SET FOREIGN_KEY_CHECKS = 1;