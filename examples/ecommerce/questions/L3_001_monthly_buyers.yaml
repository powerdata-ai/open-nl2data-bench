id: ecommerce_L3_001
version: "1.0"
domain: ecommerce
complexity: L3
question:
  en: "Find users who have made purchases in every month of 2023"
  zh: "找出2023年每个月都有购买记录的用户"
golden_sql: |
  SELECT u.id, u.name, COUNT(DISTINCT DATE_FORMAT(o.created_at, '%Y-%m')) as purchase_months
  FROM users u
  JOIN orders o ON u.id = o.user_id
  WHERE YEAR(o.created_at) = 2023
  GROUP BY u.id, u.name
  HAVING purchase_months = 12
dependencies:
  tables:
    - users
    - orders
  features:
    - JOIN
    - GROUP BY
    - HAVING
    - DATE functions
    - COUNT DISTINCT
    - WHERE
tags:
  - advanced
  - temporal
  - having
  - distinct
  - user-behavior
metadata:
  difficulty: hard
  estimated_time_ms: 1000
  author: "PowerData Community"
  created_at: "2024-01-01"
comparison_rules:
  row_order_matters: false
  column_order_matters: false
